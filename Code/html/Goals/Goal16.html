<!doctype html>
<html lang='en'>
<head>
    <meta charset='utf-8'><meta name='viewport' content='width=device-width, initial-scale=1, shrink-to-fit=no'>

    <link href='./../../CSS/bootstrap.min.css' rel='stylesheet' type='text/css'>
<link href='./../../CSS/Colours.css' rel='stylesheet' type='text/css'>
<link href='./../../CSS/Goals.css' rel='stylesheet' type='text/css'>
<link href='./../../CSS/mapbox.css' rel='stylesheet' type='text/css'>
    <title>Peace</title>
</head>

<body class=''>
<nav class='navbar navbar-dark blackB '>
    <a href="./../home.html" style="width:80%"> <img class="Logo" src="./../Images/SDGlogo.jpg" alt="SDG" ></a>
    <a href="./../createEvent.html" class="btn btn-info" role="button">Events</a>
          
        </nav>
<div class='container-fluid GoalTitle'>
    <H1 class='display-5 Viridian_Green'>Goal 16:Peace Justice and Strong Institutions<small class=' Yellow_Green'> promote peaceful and inclusive societies for sustainable
        development, provide access to justice for all and build effective, accountable and inclusive institutions at all levels.</small></H1>
</div>
<div class='card container justify-content-center Rose_RedB HowToHelp' style='width: 80%;'>
    <div class='media '>
        <div class='media-body'>
            <h5 class='mt-0 display-5 '>How To Help</h5>
            <p class='lead '>Find a charity to support
                Donate what you donâ€™t use to local charities or those in need</p>
        </div>
    </div>
</div>
<div class='container-fluid justify-content-center' >
    <H3 class='display-5 Viridian_Green'>Local Charities</H1>
</div>
<div class='row justify-content-center'>
    <div class='card Yellow_GreenB EID' style='max-width: 30%;'>
        <h4 >Peace Justice and Strong Institutions</h4>
        <hr class='my-4'>
        <p>Introduce a new Community infrastructure Fund, using the 'Dundee Decides' participatory budgeting process to give
            local people a say in spending on local infracture.</p>
        <p class='lead'>
            <a class='btn Yellow_Green btn-lg' href='https://www.gov.uk/government/publications/housing-infrastructure-fund' role='button'>Learn more</a>
        </p>
    </div>
    <div class='card Yellow_GreenB EID' style='max-width: 30%;'>
        <h4 >Peace Justice and Strong Institutions</h4>
        <hr class='my-4'>
        <p> Deliver a more interated health and social care service though Dundee Health and Social Care Partnership.</p>
        <p class='lead'>
            <a class='btn Yellow_Green btn-lg' href='https://www.nhstayside.scot.nhs.uk/OurServicesA-Z/DundeeHealthandSocialCarePartnership/index.htm' role='button'>Learn more</a>
        </p>
    </div>
    <div class='card Yellow_GreenB EID' style='max-width: 30%;'>
        <h4 >Peace Justice and Strong Institutions</h4>
        <hr class='my-4'>
        <p>Support Dundee's Protecting People Framework, which co-ordinates multi-agency work on child protection,
            vulnerable adults, violence against women, alcohol and drug misuse and racist incidents.</p>
        <p class='lead'>
            <a class='btn Yellow_Green btn-lg' href='https://www.gov.scot/publications/national-guidance-child-protection-scotland/' role='button'>Learn more</a>
        </p>
    </div>
</div>
<div class="d-flex justify-content-center mb-2">
  <div id='map' style='width: 400px; height: 300px;'></div>
</div>
<div class=' row  justify-content-center'>
    <nav aria-label='Page navigation example'>
      <ul class='pagination pagination-lg'>
        <li class='page-item'><a class='page-link Viridian_Green' href='Goal15.php'>Previous</a></li>
	<li class='page-item'><a class='page-link Viridian_Green' href='Goal13.php'>13</a></li>
        <li class='page-item'><a class='page-link Viridian_Green' href='Goal14.php'>14</a></li>
        <li class='page-item'><a class='page-link Viridian_Green' href='Goal15.php'>15</a></li>
	<li class='page-item'><span class='page-link disabled CurrentGoal'>16</span></li>
        <li class='page-item'><a class='page-link Viridian_Green' href='Goal17.php'>17</a></li>
        <li class='page-item'><a class='page-link Viridian_Green' href='Goal17.php'>Next</a></li>
      </ul>
    </nav>
    </div>
</body>

<script>
    mapboxgl.accessToken = 'pk.eyJ1Ijoia2hhZWxlbXdhdHQiLCJhIjoiY2syczhpdGFhMGU3ejNnbnozYXB0cm03YSJ9.GCaekm2x9qIeIWZe_Kq5LA';
    var map = new mapboxgl.Map({
      container: 'map',
      style: 'mapbox://styles/mapbox/streets-v11',
      center: [-3.002864, 56.472182],
      zoom: 11.15,
    });
  
    // Add zoom and rotation controls to the map.
    map.addControl(new mapboxgl.NavigationControl());
  
  
    //Fetches all events related to one goal and sends the data to load in the markers
    fetch('https://group9agilewebapp.azurewebsites.net/api/devEvents/16')
    .then(response => response.json())
    .then(data => {
      loadMarkers(data);
    })
    .catch((error) => {
    console.error('Error:', error);
    });
  
    //Takes in JSON data and displays their marker on the map
    function loadMarkers(data){
      var markers = [];
      console.log(data);
      console.log(Object.keys(data).length);
  
      for(var i=0; i < Object.keys(data).length; i++){
        var desc = "<strong>" + data[i].Name + "</strong><p class='popup-text' id='" + data[i].EventId + "'>" + data[i].Info + "</p><br><p>" + data[i].Date + "</p>";
        var obj = {'type': 'Feature','properties': {'description': desc},'geometry': {'type': 'Point','coordinates': [data[i].Longitude, data[i].Latitude]}};
        markers.push(obj);
  
        map.on('load', () => {
          map.addSource('places', {
            'type': 'geojson',
            'data': {
              'type': 'FeatureCollection',
              'features': markers
            }
          });
          console.log(i);
          // Add a layer showing the places.
          map.addLayer({
            'id': 'places',
            'type': 'circle',
            'source': 'places',
            'paint': {
              'circle-color': '#4264fb',
              'circle-radius': 6,
              'circle-stroke-width': 2,
              'circle-stroke-color': '#ffffff'
            }
          });
          
          // Create a popup, but don't add it to the map yet.
          const popup = new mapboxgl.Popup({
            closeButton: false,
            closeOnClick: false
          });
  
          map.on('click', 'places', (e) => {
            var text = document.getElementsByClassName("popup-text")[0];
            sessionStorage.setItem("singleEvent", text.id);
            window.location.href = "https://khaelemwatt.github.io/AC31007CourseworkGroup9/Code/html/eventInfo.html";
          })
          
          map.on('mouseenter', 'places', (e) => {
            // Change the cursor style as a UI indicator.
            map.getCanvas().style.cursor = 'pointer';
            
            // Copy coordinates array.
            const coordinates = e.features[0].geometry.coordinates.slice();
            const description = e.features[0].properties.description;
            
            // Ensure that if the map is zoomed out such that multiple
            // copies of the feature are visible, the popup appears
            // over the copy being pointed to.
            while (Math.abs(e.lngLat.lng - coordinates[0]) > 180) {
              coordinates[0] += e.lngLat.lng > coordinates[0] ? 360 : -360;
            }
            
            // Populate the popup and set its coordinates
            // based on the feature found.
            popup.setLngLat(coordinates).setHTML(description).addTo(map);
          });
          
          map.on('mouseleave', 'places', () => {
            map.getCanvas().style.cursor = '';
            popup.remove();
          });
        });
      }   
    } 
    </script>

<script src='https://cdn.jsdelivr.net/npm/jquery@3.5.1/dist/jquery.slim.min.js' integrity='sha384-DfXdz2htPH0lsSSs5nCTpuj/zy4C+OGpamoFVy38MVBnE+IbbVYUew+OrCXaRkfj' crossorigin='anonymous'></script>
<script src='./../../js/bootstrap.bundle.js' ></script>

</html>
