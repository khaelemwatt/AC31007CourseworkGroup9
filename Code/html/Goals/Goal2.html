<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

<link href='./../../CSS/bootstrap.min.css' rel='stylesheet' type='text/css'>
<link href='./../../CSS/Colours.css' rel='stylesheet' type='text/css'>
<link href='./../../CSS/Goals.css' rel='stylesheet' type='text/css'>
<title>Zero Hunger</title>
</head>

<body class="">
      <div class="pos-f-t ">
        <div class="collapse" id="navbarToggleExternalContent">
          <div class="blackB p-4">
            <h4 class="text-white"></h4>
            <span class="text-muted"></span>
          </div>
        </div>
        <nav class="navbar navbar-dark blackB ">
          <a href="./../home.html" style="width:80%"> <img class="Logo" src="./../Images/SDGlogo.jpg" alt="SDG" ></a>
          <a href="./../createEvent.html" class="btn btn-info" role="button">Events</a>
          
        </nav>
      </div>
    <div class="container-fluid GoalTitle">
        <H1 class="display-5 Viridian_Green">Goal 2: Zero Hunger<br><small class=" Yellow_Green">End hunger, achieve food security and improved nutrition and promote sustainable agriculture</small></H1>
    </div>
    <div class="card  justify-content-center Rose_RedB HowToHelp" >
        
          <h5 class=" display-5">How To Help</h5>
          <p class="lead">Buy local and in-season food.
          Try growing some of your own food
          Donlt waste food
          Buy "funny fruit" many fruits and vegetables are thrown out because their size, shape, or color are not “right”. Buying these perfectly good funny fruit, utilizes food that might otherwise go to waste.
          Consume less meat, eat more plant based. 
          </p> 
    </div>
    <div class="container-fluid justify-content-center GoalTitle" >
        <H3 class="display-5 Viridian_Green">Local Charities</H1>
    </div>
      <div class="row justify-content-center ">
        <div class="card Yellow_GreenB EID" style="max-width: 30%;">
            <h4 >Dundee Community Fridge (Gate Church Carbon Saving Project)</h4>
            <hr class="my-4">
            <p>The Community Fridge at Gate Church is a communal place where surplus food is shared, by local businesses and individuals. The community fridge helps to cut food waste, build bonds within the community and re-distribute good quality food. Although the focus is on  food waste, the Community Fridge also helps to reduce food poverty in Dundee. </p>
            <p class="lead">
              <a class="btn Viridian_Green btn-lg" href="https://www.gatechurch.co.uk/carbonsavingproject" role="button">Learn more</a>
            </p>
          </div>
          <div class="card Yellow_GreenB EID" style="max-width: 30%;">
            <h4 >Dundee and Angus Foodbank</h4>
            <hr class="my-4">
            <p>The Dundee and Angus Foodbank provide emergency food parcels for those in need and support people in crisis. It is part of a nationwide network of foodbanks, supported by The Trussell Trust, working to combat poverty and hunger across the UK. Locations both in Dundee and Angus. </p>
            <p class="lead">
              <a class="btn Viridian_Green btn-lg" href="https://dundeeandangus.foodbank.org.uk/" role="button">Learn more</a>
            </p>
          </div>
          <div class="card Yellow_GreenB EID" style="max-width: 30%;">
            <h4 >Taught by Muhammad</h4>
            <hr class="my-4">
            <p>Taught By Muhammad is an outreach project aimed at building an understanding between Muslims and the wider community. The project also helps tackle social injustices within Dundee. They have several projects including curry kitchens where they cook for the homeless, a foodbank and schools outreach. 
            *Potential for presentations in schools*</p>
            <p class="lead">
              <a class="btn Viridian_Green btn-lg" href="http://www.taughtbymuhammad.com/" role="button">Learn more</a>
            </p>
          </div>
          <div class="card Yellow_GreenB EID" style="max-width: 30%;">
            <h4 >FareShare Dundee</h4>
            <hr class="my-4">
            <p>FareShare Dundee collects/receives surplus quality food. The food is distributed to community organisations providing residential and day services for disadvantaged groups of people in Dundee, Perth & Kinross and Angus.</p>
            <p class="lead">
              <a class="btn Viridian_Green btn-lg" href="http://www.taughtbymuhammad.com/" role="button">Learn more</a>
            </p>
          </div>
    </div>
    <div class=" row  justify-content-center">
    <nav aria-label="Page navigation example">
      <ul class="pagination pagination-lg">
        <li class="page-item"><a class="page-link Viridian_Green" href="Goal1.php">Previous</a></li>
        <li class="page-item"><a class="page-link Viridian_Green" href="Goal1.php">1</a></li>
        <li class="page-item"><span class="page-link disabled CurrentGoal">2</span></li>
        <li class="page-item"><a class="page-link Viridian_Green" href="Goal3.php">3</a></li>
        <li class="page-item"><a class="page-link Viridian_Green" href="Goal4.php">4</a></li>
        <li class="page-item"><a class="page-link Viridian_Green" href="Goal5.php">5</a></li>
        <li class="page-item"><a class="page-link Viridian_Green" href="Goal3.php">Next</a></li>
      </ul>
    </nav>
    </div>
</body>

<script>
  mapboxgl.accessToken = 'pk.eyJ1Ijoia2hhZWxlbXdhdHQiLCJhIjoiY2syczhpdGFhMGU3ejNnbnozYXB0cm03YSJ9.GCaekm2x9qIeIWZe_Kq5LA';
  var map = new mapboxgl.Map({
    container: 'map',
    style: 'mapbox://styles/mapbox/streets-v11',
    center: [-3.002864, 56.472182],
    zoom: 11.15,
  });

  // Add zoom and rotation controls to the map.
  map.addControl(new mapboxgl.NavigationControl());


  //Fetches all events related to one goal and sends the data to load in the markers
  fetch('https://group9agilewebapp.azurewebsites.net/api/devEvents/2')
  .then(response => response.json())
  .then(data => {
    loadMarkers(data);
  })
  .catch((error) => {
  console.error('Error:', error);
  });

  //Takes in JSON data and displays their marker on the map
  function loadMarkers(data){
    var markers = [];
    console.log(data);
    console.log(Object.keys(data).length);

    for(var i=0; i < Object.keys(data).length; i++){
      var desc = "<strong>" + data[i].Name + "</strong><p class='popup-text' id='" + data[i].EventId + "'>" + data[i].Info + "</p><br><p>" + data[i].Date + "</p>";
      var obj = {'type': 'Feature','properties': {'description': desc},'geometry': {'type': 'Point','coordinates': [data[i].Longitude, data[i].Latitude]}};
      markers.push(obj);

      map.on('load', () => {
        map.addSource('places', {
          'type': 'geojson',
          'data': {
            'type': 'FeatureCollection',
            'features': markers
          }
        });
        console.log(i);
        // Add a layer showing the places.
        map.addLayer({
          'id': 'places',
          'type': 'circle',
          'source': 'places',
          'paint': {
            'circle-color': '#4264fb',
            'circle-radius': 6,
            'circle-stroke-width': 2,
            'circle-stroke-color': '#ffffff'
          }
        });
        
        // Create a popup, but don't add it to the map yet.
        const popup = new mapboxgl.Popup({
          closeButton: false,
          closeOnClick: false
        });

        map.on('click', 'places', (e) => {
          var text = document.getElementsByClassName("popup-text")[0];
          sessionStorage.setItem("singleEvent", text.id);
          window.location.href = "https://khaelemwatt.github.io/AC31007CourseworkGroup9/Code/html/eventInfo.html";
        })
        
        map.on('mouseenter', 'places', (e) => {
          // Change the cursor style as a UI indicator.
          map.getCanvas().style.cursor = 'pointer';
          
          // Copy coordinates array.
          const coordinates = e.features[0].geometry.coordinates.slice();
          const description = e.features[0].properties.description;
          
          // Ensure that if the map is zoomed out such that multiple
          // copies of the feature are visible, the popup appears
          // over the copy being pointed to.
          while (Math.abs(e.lngLat.lng - coordinates[0]) > 180) {
            coordinates[0] += e.lngLat.lng > coordinates[0] ? 360 : -360;
          }
          
          // Populate the popup and set its coordinates
          // based on the feature found.
          popup.setLngLat(coordinates).setHTML(description).addTo(map);
        });
        
        map.on('mouseleave', 'places', () => {
          map.getCanvas().style.cursor = '';
          popup.remove();
        });
      });
    }   
  } 
  </script>

<script src='https://cdn.jsdelivr.net/npm/jquery@3.5.1/dist/jquery.slim.min.js' integrity='sha384-DfXdz2htPH0lsSSs5nCTpuj/zy4C+OGpamoFVy38MVBnE+IbbVYUew+OrCXaRkfj' crossorigin='anonymous'></script>
<script src='./../../js/bootstrap.bundle.js' ></script>

</html>