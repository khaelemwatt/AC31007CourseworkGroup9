<!DOCTYPE html>
<html lang="">

<head>
    <meta charset='utf-8'><meta name='viewport' content='width=device-width, initial-scale=1, shrink-to-fit=no'>
    <link href='https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css' rel='stylesheet' type='text/css'>
    <title>Create Event</title>
</head>

<body>
<form id="form">
        <div class="form-group">
            <label for="name">Name</label>
            <input type="text" class="form-control" id="name" required>
        </div>
        <div class="form-group" id="location">
            <label for="location">Location</label>
            <input type="text" class="form-control" id="location" required>
        </div>
        <div class="form-group">
            <label for="date">Date (yyyy-mm-dd)</label>
            <input type="date" class="form-control" placeholder="" aria-label="Search" id="date" required>
        </div>
        <div class="form-group">
            <label for="infoInput">Info</label>
            <textarea class="form-control" id="info" rows="3" required></textarea>
        </div>
		<div class="form-group">
            <label for="goalSelect">Goal ID</label>
            <select class="form-control" id="goal" required>
                <option disabled selected value> -- select an option -- </option>
                <option value="" disabled>Please select...</option>
                <option value="1">No Poverty</option>
                <option value="2">Zero Hunger</option>
                <option value="3">Good Health and Wellbeing</option>
                <option value="4">Quality Education</option>
                <option value="5">Gender Equality</option>
                <option value="6">Clean Water and Sanitation</option>
                <option value="7">Affordable and Clean Energy</option>
                <option value="8">Decent Work and Economic Growth</option>
                <option value="9">Industry, Innovation and Infrastructure</option>
                <option value="10">Reduced Inequality</option>
                <option value="11">Sustainable Cities and Communities</option>
                <option value="12">Responsible Consumption and Production</option>
                <option value="13">Climate Action</option>
                <option value="14">Life Below Water</option>
                <option value="15">Life on Land</option>
                <option value="16">Peace and Justice, Strong Insitutions</option>
                <option value="17">Partnerships to Achieve Goal</option>
            </select>
        </div>
		<div class="form-row text-center"> 
            <button class="btn btn-secondary" type="submit" name="submit">Submit</button>
        </div>
    </form>

 <script>
    var form = document.getElementById("form");
    var json = '{"type":"FeatureCollection","query":["chester"],"features":[{"id":"place.2231300684375880","type":"Feature","place_type":["place"],"relevance":1,"properties":{"wikidata":"Q3014459"},"text":"Chester","place_name":"Chester, New Jersey, United States","bbox":[-74.740621662,40.732998091,-74.623717003,40.834595959],"center":[-74.6968,40.7843],"geometry":{"type":"Point","coordinates":[-74.6968,40.7843]},"context":[{"id":"district.15641134561761970","wikidata":"Q498163","text":"Morris County"},{"id":"region.8524001885700330","short_code":"US-NJ","wikidata":"Q1408","text":"New Jersey"},{"id":"country.19678805456372290","wikidata":"Q30","short_code":"us","text":"United States"}]},{"id":"poi.352187424293","type":"Feature","place_type":["poi"],"relevance":1,"properties":{"foursquare":"4be404641dd22d7f88eb97bd","landmark":true,"address":"17 W Main St","category":"bagel, shop"},"text":"Chester Bagels and Deli","place_name":"Chester Bagels and Deli, 17 W Main St, Chester, New Jersey 07930, United States","center":[-74.699483,40.782666],"geometry":{"coordinates":[-74.699483,40.782666],"type":"Point"},"context":[{"id":"neighborhood.18099598004235870","text":"Milltown"},{"id":"postcode.18500963620593220","text":"07930"},{"id":"place.2231300684375880","wikidata":"Q3014459","text":"Chester"},{"id":"district.15641134561761970","wikidata":"Q498163","text":"Morris County"},{"id":"region.8524001885700330","short_code":"US-NJ","wikidata":"Q1408","text":"New Jersey"},{"id":"country.19678805456372290","wikidata":"Q30","short_code":"us","text":"United States"}]},{"id":"poi.197568584834","type":"Feature","place_type":["poi"],"relevance":1,"properties":{"foursquare":"4b7e927cf964a5205ef32fe3","landmark":true,"address":"27 W Main St","category":"butcher, meat, seafood, butcher, deli, shop"},"text":"Chester Meat Market","place_name":"Chester Meat Market, 27 W Main St, Chester, New Jersey 07930, United States","center":[-74.700143,40.782495],"geometry":{"coordinates":[-74.700143,40.782495],"type":"Point"},"context":[{"id":"neighborhood.18099598004235870","text":"Milltown"},{"id":"postcode.18500963620593220","text":"07930"},{"id":"place.2231300684375880","wikidata":"Q3014459","text":"Chester"},{"id":"district.15641134561761970","wikidata":"Q498163","text":"Morris County"},{"id":"region.8524001885700330","short_code":"US-NJ","wikidata":"Q1408","text":"New Jersey"},{"id":"country.19678805456372290","wikidata":"Q30","short_code":"us","text":"United States"}]},{"id":"poi.584115575790","type":"Feature","place_type":["poi"],"relevance":1,"properties":{"foursquare":"4bade136f964a5208f6f3be3","landmark":true,"address":"65 Us Highway 206 S","category":"breakfast spot"},"text":"Chester Diner","place_name":"Chester Diner, 65 Us Highway 206 S, Chester, New Jersey 07930, United States","center":[-74.69817,40.782083],"geometry":{"coordinates":[-74.69817,40.782083],"type":"Point"},"context":[{"id":"neighborhood.18099598004235870","text":"Milltown"},{"id":"postcode.18500963620593220","text":"07930"},{"id":"place.2231300684375880","wikidata":"Q3014459","text":"Chester"},{"id":"district.15641134561761970","wikidata":"Q498163","text":"Morris County"},{"id":"region.8524001885700330","short_code":"US-NJ","wikidata":"Q1408","text":"New Jersey"},{"id":"country.19678805456372290","wikidata":"Q30","short_code":"us","text":"United States"}]},{"id":"poi.42949722868","type":"Feature","place_type":["poi"],"relevance":1,"properties":{"foursquare":"4ce2a846c4f6a35d86f3e16c","landmark":true,"address":"191-279 County Highway 513","category":"libraries, library","maki":"library"},"text":"Chester Library","place_name":"Chester Library, 191-279 County Highway 513, Chester, New Jersey 07930, United States","center":[-74.706731,40.781232],"geometry":{"coordinates":[-74.706731,40.781232],"type":"Point"},"context":[{"id":"neighborhood.18099598004235870","text":"Milltown"},{"id":"postcode.18500963620593220","text":"07930"},{"id":"place.2231300684375880","wikidata":"Q3014459","text":"Chester"},{"id":"district.15641134561761970","wikidata":"Q498163","text":"Morris County"},{"id":"region.8524001885700330","short_code":"US-NJ","wikidata":"Q1408","text":"New Jersey"},{"id":"country.19678805456372290","wikidata":"Q30","short_code":"us","text":"United States"}]}],"attribution":"NOTICE: Â© 2021 Mapbox and its suppliers. All rights reserved. Use of this data is subject to the Mapbox Terms of Service (https://www.mapbox.com/about/maps/). This response and the information it contains may not be retained. POI(s) provided by Foursquare."}';
    json = JSON.parse(json);
    console.log(json);
    console.log(json["features"][0]);
    console.log(json["features"][0]["geometry"]);
    console.log(json["features"][0]["geometry"]["coordinates"]);
    


    form.onsubmit = (e) => {

        e.preventDefault();

        var nameInput = document.getElementById("name");
        var infoInput = document.getElementById("info");
        var dateInput = document.getElementById("date");
        var locationInput = document.getElementById("location");
        var goalInput = document.getElementById("goal");
        var locationInput = document.getElementById("location").value;
        //Sanitise locationInput

        var url = "https://api.mapbox.com/geocoding/v5/mapbox.places/" + locationInput + ".json?proximity=-2.0,56.0&access_token=pk.eyJ1Ijoia2hhZWxlbXdhdHQiLCJhIjoiY2syczhpdGFhMGU3ejNnbnozYXB0cm03YSJ9.GCaekm2x9qIeIWZe_Kq5LA"
        fetch(url)
        .then(response => response.json())
        .then(data => {
            getCoords(data);
        })
        .catch((error) => {
        console.error('Error:', error);
        });

        function getCoords(data){
            //placeholder
        }

        var parameters = {"name": nameInput.value, "info": infoInput.value, "date": dateInput.value, "location": locationInput.value, "goalID": goalInput.value};
        console.log(parameters);

        fetch('https://group9agilewebapp.azurewebsites.net/createEvent', {
            method: 'POST', // or 'PUT'
            headers: {
                'Content-Type': 'application/json',
            },
            body: JSON.stringify(parameters),
            });
    };
 </script>

  
</html>
